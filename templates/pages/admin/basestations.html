{% extends 'layouts/base.html' %}

{% block title %}HOOP | Basestations{% endblock %}

{% block header %} 
<h2>Basestations
    <a href="{{ url_for('index') }}" title="Back to homepage"><i class="fa fa-home pull-right"></i></a>
</h2>
{% endblock %} 

{% block content %}

<form class="search" method="post" action="/search/basestations">
    <input class="form-control" type="text" id="search_box" placeholder="Find basestation" aria-label="Search">
</form>

{% for message in get_flashed_messages() %}
<div class=flash>
    {{ message }}
</div>
{% endfor %}

<table class="table table-hover table-bordered">

    <thead>
        <tr>
            <th>S/N</th>
            <th>Basestation ID</th>
            <th>Basestation Name</th>
            <th>Basestation Address</th>
            <th>Basestation Contact</th>
            <th></th>
        </tr>
    </thead>
    <tbody class="table-group-divider" id="search">
        {% for basestation in response: %}
        <tr>
            <td>{{ response.index(basestation) + 1 }}</td>
            <td>
                <a href="{{ url_for('update_basestation', basestation_id=basestation.basestation_id) }}">
                    {{ basestation.basestation_id }}
                </a>
            </td>
            <td>{{ basestation.basestation_name }}</td>
            <td>{{ basestation.basestation_location }}</td>
            <td>{{ basestation.basestation_contact }}</td>
            <td><a href="{{ url_for('delete_basestation', basestation_id=basestation.basestation_id)}}" onclick="return confirm('Are you sure you want to delete this basestation?');">❌</a></td>
        </tr>
        {% endfor %}
    </tbody>

</table>

{% endblock %}

{% block scripts %}
<script>
    $(document).ready(function () {
        $("#search_box").on("input", function (e) {
            search_text = $("#search_box").val();
            $("#search").empty();
            // console.log(text)
            $.ajax({
                method: "post",
                url: "/search/basestations",
                data: { text: search_text },
                success: function (res) {
                    var data;
                    $.each(res, function (index, value) {
                        data += "<tr>";
                        data += "<td>" + (index + 1) + "</td>";
                        data += "<td><a href='{{url_for('update_basestation', basestation_id=basestation_id)}}'>" + value.basestation_id + "</a></td>";
                        data += "<td>" + value.basestation_name + "</td>";
                        data += "<td>" + value.basestation_location + "</td>";
                        data += "<td>" + value.basestation_contact + "</td>";
                        data += '<td><a href="{{ url_for("delete_basestation", basestation_id=basestation_id) }}" onclick="return confirm("Are you sure you want to delete this vlan?");">❌</a></td>';
                        data += "</tr>";
                    });
                    $("#search").html(data);
                }
            })
        });
    })
</script>
{% endblock %}
